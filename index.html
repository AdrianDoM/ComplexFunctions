<html>
  <head>
    <title>Complex Functions</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/6.2.2/math.min.js"></script>
    <script type="text/javascript" src="variable.js"></script>
    <script type="text/javascript" src="interval.js"></script>
    <script type="text/javascript" src="contour.js"></script>
    <script type="text/javascript" src="deltavar.js"></script>
    <script type="text/javascript" src="cumvar.js"></script>
    <script type="text/javascript" src="plot.js"></script>
    <script type="text/javascript" src="display.js"></script>

    <style>
      .plot {
        border: solid black 2px;
        box-sizing: content-box;
        margin: 10px;
      }

      #domain {
        border-color: red;
      }

      #image {
        border-color: blue;
      }
    </style>

  </head>
  <body>
    <h1>Complex Functions</h1>

    <canvas class="plot" id="domain" width="400px" height="400px"></canvas>
    <canvas class="plot" id="image"  width="400px" height="400px"></canvas>
    <canvas class="plot" id="diffs" width="400px" height="400px"></canvas>

    <p><button id="domainReset">Reset view</button> z = <span id="z">undefined</span></p>
    <p><button id="imageReset">Reset view</button> f(z) = <span id="w">undefined</span></p>
    <p>âˆ«f(z)dz = <span id="swdz">undefined</span></p>
    
    <p><button id="animate">Animate contour</button></p>

    <script>
      const
      domainCanv = document.getElementById('domain'),
      imageCanv  = document.getElementById('image'),
      diffsCanv  = document.getElementById('diffs')
      zSpan      = document.getElementById('z'),
      wSpan      = document.getElementById('w'),
      swdzSpan   = document.getElementById('swdz')
      dResetButton  = document.getElementById('domainReset'),
      iResetButton  = document.getElementById('imageReset'),
      animateButton = document.getElementById('animate')

      const
      t    = new Interval('t', 0, 2*Math.PI, 200, 20, true),
      c    = new Contour('c', 'e^(i*t)', t),
      z    = new Variable('z', c.func, [t.midpoint], 'red'),
      w    = new Variable('w', '1/z', [z], 'darkOrange'),
      dz   = new DeltaVar('dz', c),
      wdz  = new Variable('wdz', 'w * dz', [w, dz], 'deeppink'),
      swdz = new CumVar('swdz', wdz),
      m    = new Variable('m'),
      n    = new Variable('n', '1/m', [m], 'darkOrange'),
      dm   = new DeltaVar('dm', m, undefined, undefined, 100),
      ndm  = new Variable('ndm', 'n * dm', [n, dm], 'deeppink'),
      sndm = new CumVar('sndm', ndm)

      const
      domainPlot = new Plot(domainCanv, [c, z], m),
      imagePlot  = new Plot(imageCanv, [w, swdz, n, sndm]),
      diffsPlot  = new Plot(diffsCanv, [dz, wdz, dm, ndm]),
      displayZ    = new Display(zSpan, z),
      displayW    = new Display(wSpan, w),
      displaySwdz = new Display(swdzSpan, swdz)

      dResetButton.onclick  = () => domainPlot.resetView()
      iResetButton.onclick  = () => imagePlot.resetView()
      animateButton.onclick = () => t.animate(false)
    </script>

  </body>
</html>